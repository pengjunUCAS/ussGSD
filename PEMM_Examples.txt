

    ### Load the functions.
    source("PEMM.txt")

 
    ### Load the GSD dataset.
    DAT <- read.table("GrainSizeData.txt") 


    ### Perform parametric end-member modelling with the Skew Normal distribution,
    ### using the R function PEMM(). You may use function PEMMp() instead.
    RES_PEMM <- PEMMp(GSDmat=DAT, ncomp=6, csv=TRUE, ntry=50, kkf=0.2, ctf=-0.2,
                     model="skewnormal0", useIndex=TRUE, pdfname="EndMember_SG", 
                     nr=11, nc=10)

 
    ### Names of elements stored in object "RES_PEMM".
    names(RES_PEMM)

  
    ### Matrix M.
    M <- RES_PEMM$abundance


    ### Matrix B.
    B <- RES_PEMM$endmember


    ### Predicted matrix X (M %*% B)
    X <- RES_PEMM$fitGSD


    ### Optimized parameters.
    RES_PEMM$pars